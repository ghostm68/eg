<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Three Character Notes</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Lobster&family=Merriweather:wght@300;400;700&family=Playfair+Display:wght@400;700&family=Open+Sans:wght@300;400;700&family=Lora:wght@400;700&family=Courier+Prime:wght@400;700&display=swap');

    :root {
      --primary-color: #ff0000;
      --bg-color: #f0f0f0;
      --card-bg: #fff;
      --text-color: #333;
      --border-color: #ddd;
    }

    body {
      font-family: 'Inter', sans-serif;
      font-weight: 400;
      line-height: 1.6;
      margin: 0;
      padding: 20px;
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background-color: var(--card-bg);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      color: #4a4a4a;
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      font-size: 3em;
      margin-bottom: 30px;
      letter-spacing: -0.02em;
    }

    h2 {
      font-family: 'Inter', sans-serif;
      font-weight: 600;
    }

    h3 {
      font-family: 'Inter', sans-serif;
      font-weight: 600;
    }

    .settings-bar {
      background-color: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      align-items: center;
    }

    .settings-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .settings-group label {
      font-size: 0.85em;
      color: #666;
      font-weight: 500;
    }

    .settings-group select,
    .settings-group input {
      padding: 5px 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 0.9em;
      font-family: 'Inter', sans-serif;
    }

    .character-names {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .character-names input {
      width: 120px;
    }

    .entry-forms {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
      gap: 15px;
    }

    .entry-form {
      flex: 1;
      background-color: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .entry-form h2 {
      text-align: center;
      color: #4a4a4a;
      margin-top: 0;
    }

    .entry-form textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      resize: vertical;
      min-height: 150px;
      font-family: 'Inter', sans-serif;
      font-weight: var(--editor-weight, 400);
      font-size: var(--editor-size, 14px);
      line-height: 1.6;
    }

    .entry-form button {
      width: 100%;
      padding: 10px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: background-color 0.3s;
    }

    .entry-form button:hover {
      opacity: 0.9;
    }

    .entries {
      display: flex;
      justify-content: space-between;
      gap: 15px;
    }

    .entry-column {
      flex: 1;
      background-color: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .entry {
      background-color: var(--card-bg);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      position: relative;
    }

    .entry p {
      margin-bottom: 10px;
      font-family: 'Inter', sans-serif;
      font-weight: var(--display-weight, 400);
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .entry-date {
      font-size: 0.8em;
      color: #888;
    }

    .entry-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }

    .entry-actions button {
      padding: 5px 10px;
      font-size: 0.8em;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      transition: opacity 0.3s;
    }

    .edit-btn {
      background-color: #2196F3;
      color: white;
    }

    .delete-btn {
      background-color: #f44336;
      color: white;
    }

    .entry-actions button:hover {
      opacity: 0.8;
    }

    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
    }

    .action-buttons button {
      padding: 10px 20px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: background-color 0.3s;
    }

    .action-buttons button:hover {
      opacity: 0.9;
    }

    #slide-menu {
      position: fixed;
      top: 0;
      left: -350px;
      width: 350px;
      height: 100%;
      background-color: rgba(255, 0, 0, 0.95);
      color: white;
      padding: 20px;
      box-sizing: border-box;
      transition: left 0.3s ease-in-out;
      z-index: 999;
      overflow-y: auto;
    }

    #slide-menu h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    #slide-menu nav ul {
      list-style-type: none;
      padding: 0;
    }

    #slide-menu nav li a {
      color: white;
      text-decoration: none;
      display: block;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,0.3);
    }

    #slide-menu h3 {
      margin-top: 30px;
    }

    #slide-menu ol {
      padding-left: 20px;
    }

    #close-menu {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
      border-radius: 10px;
    }

    .modal-content textarea {
      width: 100%;
      min-height: 200px;
      padding: 10px;
      font-family: 'Inter', sans-serif;
      font-weight: var(--editor-weight, 400);
      font-size: var(--editor-size, 14px);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      resize: vertical;
    }

    .modal-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 15px;
    }

    .modal-buttons button {
      padding: 8px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .entry-forms, .entries {
        flex-direction: column;
      }
      
      .settings-bar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .character-names {
        flex-direction: column;
      }
      
      .character-names input {
        width: 100%;
      }
    }

    .word-count-display {
      font-size: 0.75em;
      color: #888;
      margin-top: 5px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <div id="menu-toggle" style="position: fixed; top: 20px; right: 20px; z-index: 1000; cursor: pointer; background-color: rgba(255, 255, 255, 0.8); padding: 5px; border-radius: 5px;">
    <svg width="30" height="30" viewBox="0 0 100 100">
      <rect width="100" height="20" rx="8" fill="red"></rect>
      <rect y="40" width="100" height="20" rx="8" fill="red"></rect>
      <rect y="80" width="100" height="20" rx="8" fill="red"></rect>
    </svg>
  </div>

  <div id="slide-menu">
    <h2>Settings & Info</h2>
    <nav>
      <ul>
        <li><a href="#" onclick="document.getElementById('slide-menu').style.left = '-350px'">Close Menu</a></li>
      </ul>
    </nav>
    <h3>How to Use This App</h3>
    <ol>
      <li>Customize your character names in the settings bar</li>
      <li>Choose your preferred font for writing and display</li>
      <li>Write entries in any of the three character columns</li>
      <li>Click "Jot" to save your entry</li>
      <li>Edit or delete entries using the buttons on each entry</li>
      <li>Download individual or all entries at any time</li>
      <li>All entries are automatically saved to your browser</li>
    </ol>
    <h3>Features</h3>
    <ul>
      <li>✓ Three parallel storylines/characters</li>
      <li>✓ Custom character naming</li>
      <li>✓ Font selection for writing & display</li>
      <li>✓ Edit and delete entries</li>
      <li>✓ Export to text files</li>
      <li>✓ Automatic local storage</li>
    </ul>
    <p>Happy writing!</p>
    <button id="close-menu">×</button>
  </div>

  <div class="container" style="background-image: url('https://media.tenor.com/sybYHIOkhhgAAAAC/noise-tv.gif'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed; background-blend-mode: overlay; background-color: rgba(255, 255, 255, 0.95);">
    <h1>Three Character Notes</h1>
    
    <div class="settings-bar">
      <div class="settings-group">
        <label for="editorWeight">Editor Style:</label>
        <select id="editorWeight">
          <option value="300">Light</option>
          <option value="400" selected>Regular</option>
          <option value="500">Medium</option>
          <option value="600">Semi-Bold</option>
        </select>
      </div>
      
      <div class="settings-group">
        <label for="displayWeight">Display Style:</label>
        <select id="displayWeight">
          <option value="300">Light</option>
          <option value="400" selected>Regular</option>
          <option value="500">Medium</option>
          <option value="600">Semi-Bold</option>
        </select>
      </div>
      
      <div class="settings-group">
        <label for="fontSize">Font Size:</label>
        <select id="fontSize">
          <option value="12px">Small</option>
          <option value="14px" selected>Medium</option>
          <option value="16px">Large</option>
          <option value="18px">Extra Large</option>
        </select>
      </div>
      
      <div class="character-names">
        <div class="settings-group">
          <label for="char1Name">Character 1:</label>
          <input type="text" id="char1Name" value="X" maxlength="20">
        </div>
        <div class="settings-group">
          <label for="char2Name">Character 2:</label>
          <input type="text" id="char2Name" value="XX" maxlength="20">
        </div>
        <div class="settings-group">
          <label for="char3Name">Character 3:</label>
          <input type="text" id="char3Name" value="XXX" maxlength="20">
        </div>
      </div>
    </div>
    
    <div class="entry-forms">
      <div class="entry-form">
        <h2 id="char1Title">X</h2>
        <form id="char1Form">
          <textarea id="char1Entry" placeholder="Write your entry here..." required></textarea>
          <div class="word-count-display" id="char1Count">0 words</div>
          <button type="submit">Jot</button>
        </form>
      </div>
      
      <div class="entry-form">
        <h2 id="char2Title">XX</h2>
        <form id="char2Form">
          <textarea id="char2Entry" placeholder="Write your entry here..." required></textarea>
          <div class="word-count-display" id="char2Count">0 words</div>
          <button type="submit">Jot</button>
        </form>
      </div>
      
      <div class="entry-form">
        <h2 id="char3Title">XXX</h2>
        <form id="char3Form">
          <textarea id="char3Entry" placeholder="Write your entry here..." required></textarea>
          <div class="word-count-display" id="char3Count">0 words</div>
          <button type="submit">Jot</button>
        </form>
      </div>
    </div>
    
    <div class="action-buttons">
      <button onclick="downloadAllEntries()">Download All</button>
      <button onclick="downloadEntries('char1')">Download Char 1</button>
      <button onclick="downloadEntries('char2')">Download Char 2</button>
      <button onclick="downloadEntries('char3')">Download Char 3</button>
      <button onclick="clearAllEntries()" style="background-color: #f44336;">Clear All</button>
    </div>
    
    <div class="entries">
      <div class="entry-column" id="char1Entries">
        <h2 id="char1EntriesTitle">X's Entries</h2>
      </div>
      
      <div class="entry-column" id="char2Entries">
        <h2 id="char2EntriesTitle">XX's Entries</h2>
      </div>
      
      <div class="entry-column" id="char3Entries">
        <h2 id="char3EntriesTitle">XXX's Entries</h2>
      </div>
    </div>

    <footer style="color: red; text-align: center; margin-top: 20px; padding: 10px; border-top: 1px solid red;">
      © 2024 Three Character Notes. Enhanced edition.
    </footer>
  </div>

  <div id="editModal" class="modal">
    <div class="modal-content">
      <h2>Edit Entry</h2>
      <textarea id="editEntryText"></textarea>
      <div class="modal-buttons">
        <button onclick="closeEditModal()" style="background-color: #999; color: white;">Cancel</button>
        <button onclick="saveEditedEntry()" style="background-color: #2196F3; color: white;">Save</button>
      </div>
    </div>
  </div>

  <script>
    const char1Form = document.getElementById('char1Form');
    const char2Form = document.getElementById('char2Form');
    const char3Form = document.getElementById('char3Form');
    const char1EntriesList = document.getElementById('char1Entries');
    const char2EntriesList = document.getElementById('char2Entries');
    const char3EntriesList = document.getElementById('char3Entries');

    let entries = JSON.parse(localStorage.getItem('threeCharEntries')) || [];
    let settings = JSON.parse(localStorage.getItem('threeCharSettings')) || {
      char1Name: 'X',
      char2Name: 'XX',
      char3Name: 'XXX',
      editorWeight: '400',
      displayWeight: '400',
      fontSize: '14px'
    };
    
    let editingEntry = null;

    function countWords(text) {
      return text.trim().split(/\s+/).filter(w => w.length > 0).length;
    }

    function updateWordCount(textareaId, countId) {
      const textarea = document.getElementById(textareaId);
      const count = document.getElementById(countId);
      const words = countWords(textarea.value);
      count.textContent = `${words} word${words !== 1 ? 's' : ''}`;
    }

    document.getElementById('char1Entry').addEventListener('input', () => updateWordCount('char1Entry', 'char1Count'));
    document.getElementById('char2Entry').addEventListener('input', () => updateWordCount('char2Entry', 'char2Count'));
    document.getElementById('char3Entry').addEventListener('input', () => updateWordCount('char3Entry', 'char3Count'));

    function loadSettings() {
      document.getElementById('char1Name').value = settings.char1Name;
      document.getElementById('char2Name').value = settings.char2Name;
      document.getElementById('char3Name').value = settings.char3Name;
      document.getElementById('editorWeight').value = settings.editorWeight;
      document.getElementById('displayWeight').value = settings.displayWeight;
      document.getElementById('fontSize').value = settings.fontSize;
      
      applySettings();
    }

    function saveSettings() {
      settings = {
        char1Name: document.getElementById('char1Name').value,
        char2Name: document.getElementById('char2Name').value,
        char3Name: document.getElementById('char3Name').value,
        editorWeight: document.getElementById('editorWeight').value,
        displayWeight: document.getElementById('displayWeight').value,
        fontSize: document.getElementById('fontSize').value
      };
      localStorage.setItem('threeCharSettings', JSON.stringify(settings));
      applySettings();
    }

    function applySettings() {
      document.documentElement.style.setProperty('--editor-weight', settings.editorWeight);
      document.documentElement.style.setProperty('--display-weight', settings.displayWeight);
      document.documentElement.style.setProperty('--editor-size', settings.fontSize);
      
      document.getElementById('char1Title').textContent = settings.char1Name;
      document.getElementById('char2Title').textContent = settings.char2Name;
      document.getElementById('char3Title').textContent = settings.char3Name;
      
      document.getElementById('char1EntriesTitle').textContent = settings.char1Name + "'s Entries";
      document.getElementById('char2EntriesTitle').textContent = settings.char2Name + "'s Entries";
      document.getElementById('char3EntriesTitle').textContent = settings.char3Name + "'s Entries";
    }

    document.getElementById('char1Name').addEventListener('change', saveSettings);
    document.getElementById('char2Name').addEventListener('change', saveSettings);
    document.getElementById('char3Name').addEventListener('change', saveSettings);
    document.getElementById('editorWeight').addEventListener('change', saveSettings);
    document.getElementById('displayWeight').addEventListener('change', saveSettings);
    document.getElementById('fontSize').addEventListener('change', saveSettings);

    function addEntry(user, entryText) {
      const newEntry = {
        id: Date.now().toString(),
        user: user,
        text: entryText,
        date: new Date().toISOString()
      };
      entries.push(newEntry);
      localStorage.setItem('threeCharEntries', JSON.stringify(entries));
      displayEntries();
    }

    function deleteEntry(id) {
      if (confirm('Are you sure you want to delete this entry?')) {
        entries = entries.filter(entry => entry.id !== id);
        localStorage.setItem('threeCharEntries', JSON.stringify(entries));
        displayEntries();
      }
    }

    function openEditModal(id) {
      editingEntry = entries.find(entry => entry.id === id);
      if (editingEntry) {
        document.getElementById('editEntryText').value = editingEntry.text;
        document.getElementById('editModal').style.display = 'block';
      }
    }

    function closeEditModal() {
      document.getElementById('editModal').style.display = 'none';
      editingEntry = null;
    }

    function saveEditedEntry() {
      if (editingEntry) {
        const newText = document.getElementById('editEntryText').value;
        const entryIndex = entries.findIndex(e => e.id === editingEntry.id);
        if (entryIndex !== -1) {
          entries[entryIndex].text = newText;
          localStorage.setItem('threeCharEntries', JSON.stringify(entries));
          displayEntries();
          closeEditModal();
        }
      }
    }

    window.openEditModal = openEditModal;
    window.closeEditModal = closeEditModal;
    window.saveEditedEntry = saveEditedEntry;
    window.deleteEntry = deleteEntry;

    function displayEntries() {
      char1EntriesList.innerHTML = `<h2 id="char1EntriesTitle">${settings.char1Name}'s Entries</h2>`;
      char2EntriesList.innerHTML = `<h2 id="char2EntriesTitle">${settings.char2Name}'s Entries</h2>`;
      char3EntriesList.innerHTML = `<h2 id="char3EntriesTitle">${settings.char3Name}'s Entries</h2>`;

      entries.sort((a, b) => new Date(b.date) - new Date(a.date));

      entries.forEach(entry => {
        const entryElement = document.createElement('div');
        entryElement.className = 'entry';
        entryElement.innerHTML = `
          <p>${entry.text}</p>
          <div class="entry-date">${formatDate(entry.date)}</div>
          <div class="entry-actions">
            <button class="edit-btn" onclick="openEditModal('${entry.id}')">Edit</button>
            <button class="delete-btn" onclick="deleteEntry('${entry.id}')">Delete</button>
          </div>
        `;

        switch(entry.user) {
          case 'char1':
            char1EntriesList.appendChild(entryElement);
            break;
          case 'char2':
            char2EntriesList.appendChild(entryElement);
            break;
          case 'char3':
            char3EntriesList.appendChild(entryElement);
            break;
        }
      });
    }

    function formatDate(dateString) {
      const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
      return new Date(dateString).toLocaleDateString('en-US', options);
    }

    function clearAllEntries() {
      if (confirm('Are you sure you want to clear all entries? This action cannot be undone.')) {
        entries = [];
        localStorage.removeItem('threeCharEntries');
        displayEntries();
      }
    }

    window.clearAllEntries = clearAllEntries;

    char1Form.addEventListener('submit', function(e) {
      e.preventDefault();
      const entryText = document.getElementById('char1Entry').value;
      if (entryText.trim() !== '') {
        addEntry('char1', entryText);
        char1Form.reset();
        updateWordCount('char1Entry', 'char1Count');
      }
    });

    char2Form.addEventListener('submit', function(e) {
      e.preventDefault();
      const entryText = document.getElementById('char2Entry').value;
      if (entryText.trim() !== '') {
        addEntry('char2', entryText);
        char2Form.reset();
        updateWordCount('char2Entry', 'char2Count');
      }
    });

    char3Form.addEventListener('submit', function(e) {
      e.preventDefault();
      const entryText = document.getElementById('char3Entry').value;
      if (entryText.trim() !== '') {
        addEntry('char3', entryText);
        char3Form.reset();
        updateWordCount('char3Entry', 'char3Count');
      }
    });

    function downloadEntries(user) {
      const entriesForUser = entries.filter(entry => entry.user === user);
      const charName = settings[user + 'Name'];
      
      const textContent = `${charName}'s Entries\n` + 
        '='.repeat(charName.length + 10) + '\n\n' +
        entriesForUser.map(entry => 
          `${formatDate(entry.date)}\n${'-'.repeat(40)}\n${entry.text}\n\n`
        ).join('');

      const blob = new Blob([textContent], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `${charName}_entries.txt`;
      link.click();
      URL.revokeObjectURL(url);
    }

    window.downloadEntries = downloadEntries;

    function downloadAllEntries() {
      let textContent = 'Three Character Notes - Complete Export\n';
      textContent += '='.repeat(50) + '\n\n';
      
      ['char1', 'char2', 'char3'].forEach(user => {
        const entriesForUser = entries.filter(entry => entry.user === user);
        const charName = settings[user + 'Name'];
        
        textContent += `\n${charName}'s Entries\n`;
        textContent += '='.repeat(charName.length + 10) + '\n\n';
        
        entriesForUser.forEach(entry => {
          textContent += `${formatDate(entry.date)}\n`;
          textContent += '-'.repeat(40) + '\n';
          textContent += `${entry.text}\n\n`;
        });
      });

      const blob = new Blob([textContent], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'all_character_entries.txt';
      link.click();
      URL.revokeObjectURL(url);
    }

    window.downloadAllEntries = downloadAllEntries;

    const menuToggle = document.getElementById('menu-toggle');
    const slideMenu = document.getElementById('slide-menu');
    const closeMenu = document.getElementById('close-menu');
    let menuOpen = false;

    menuToggle.addEventListener('click', function() {
      toggleMenu();
    });

    closeMenu.addEventListener('click', function() {
      toggleMenu();
    });

    function toggleMenu() {
      if (menuOpen) {
        slideMenu.style.left = '-350px';
        menuOpen = false;
      } else {
        slideMenu.style.left = '0';
        menuOpen = true;
      }
    }

    document.addEventListener('click', function(event) {
      if (menuOpen && !slideMenu.contains(event.target) && event.target !== menuToggle && !menuToggle.contains(event.target)) {
        toggleMenu();
      }
    });

    window.addEventListener('click', function(event) {
      if (event.target === document.getElementById('editModal')) {
        closeEditModal();
      }
    });

    loadSettings();
    displayEntries();
  </script>
</body>
</html>
