<!DOCTYPE html>
<html lang="en">
    <meta name="description" content="Explore 'Funk & Wagnallism,' a unique dictionary with red typography, beatnik quotes, and a seamless user experience. Dive into a creative, visually captivating interface with auto-scrolling functionality and transparent design elements." />
<meta name="keywords" content="Funk & Wagnallism, dictionary, beatnik quotes, auto-scrolling, transparent design, creative interface, jazz-inspired, nexus resources, web dictionary" />

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
	/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 20px;
}

/* Track */
::-webkit-scrollbar-track {
  box-shadow: inset 0 0 5px tan; 
  border-radius: 10px;
}
 
/* Handle */
::-webkit-scrollbar-thumb {
  background: #FF0000; 
  border-radius: 10px;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  background: #ff4444; 
}
    </style>
    <title>Funk & Wagnallism</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: auto;
            background-color: #000;
            color: #fff;
            font-family: 'Roboto', sans-serif;
        }
        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            filter: blur(5px);
            transition: background-image 5s ease-in-out;
        }
        #search-container {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
        }
        #search-input {
            padding: 10px;
            border-radius: 5px;
            border: none;
            width: 300px;
            font-size: 16px;
        }
        #search-button {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            background-color: #444;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }
    #result {
    position: absolute;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    width: 80%;
    max-width: 800px;
    text-align: left;
    color: #FF0000; 
    overflow-y: auto;
    max-height: 60vh;
    padding: 10px;
    border-radius: 8px;
}

        .thought {
            position: absolute;
            opacity: 0;
            font-size: 24px;
            transition: all 2s;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
       .red-glow { /* formerly blue-glow */
    text-shadow: 0 0 10px rgba(255, 0, 0, 0.7), 0 0 20px rgba(255, 0, 0, 0.5), 0 0 30px rgba(255, 0, 0, 0.3);
}
        .grey-glow {
            text-shadow: 0 0 10px rgba(147, 172, 145, 0.8), 0 0 20px rgba(147, 172, 145, 0.7), 0 0 30px rgba(147, 172, 145, 0.6);
        }
        .white-glow {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.7), 0 0 20px rgba(255, 255, 255, 0.5), 0 0 30px rgba(255, 255, 255, 0.3);
        }
        #youtubePlayer {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
        }
        #snowCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        #controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            gap: 20px;
        }
        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
	    <!-- TEST: Does JavaScript work at all? -->
    <button onclick="alert('JS is working')" style="position:fixed; top:5px; left:5px; z-index:9999; background:red; color:white;">
        Test Click
    </button>
  <!-- Put this EXACTLY where you have the panel HTML now -->
<div id="fawPanel" style="
    display: none;
    position: fixed;
    top: 80px;
    right: -400px;
    width: 380px;
    height: 70vh;
    background: rgba(20, 0, 0, 0.95);
    border-left: 3px solid #FF0000;
    box-shadow: -5px 0 20px rgba(255, 0, 0, 0.3);
    z-index: 9999;
    padding: 20px;
    overflow-y: auto;
    transition: right 0.3s ease;
    font-family: 'Courier New', monospace;
">
    <!-- X Button: Simple, no flex, guaranteed visible -->
    <div style="text-align: right; margin-bottom: 10px;">
        <button onclick="window.toggleFW()" style="
            background: #FF0000;
            color: #000;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
            font-size: 18px;
        ">×</button>
    </div>
    
    <h2 style="margin: 0 0 15px 0; color: #FF0000; font-size: 1.2em;">
        Funk & Wagnalls<br>
        <span style="font-size: 0.7em; color: #ff4444;">Volume I (A–K) • 1906</span>
    </h2>
    
    <input type="text" id="fawInput" placeholder="Search A–K..." style="
        width: 100%;
        padding: 10px;
        background: rgba(255, 0, 0, 0.1);
        border: 1px solid #FF0000;
        color: #fff;
        margin-bottom: 15px;
        box-sizing: border-box;
    ">
    
    <div id="fawOutput" style="color: #ffcccc; font-size: 0.9em;">
        <p style="color: #ff4444; font-style: italic;">Type to search...</p>
    </div>
</div>

<!-- Header: Use window.toggleFW to ensure global access -->
<h1 style="cursor: pointer;" onclick="window.toggleFW()">
    Funk &amp; Wagnallism<br>
    <small style="font-size: 0.4em; color: #ff4444; text-decoration: underline;">
        [Volume I: A–K (1906) ↓]
    </small>
</h1>
    <div id="search-container">
        <input type="text" id="search-input" placeholder="Enter a word to look up">
        <button id="search-button">Search Dictionary (w/German)</button>
    </div>
    <div id="result"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script>
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const result = document.getElementById('result');

        const dictionaryUrls = [
            'https://raw.githubusercontent.com/matthewreagan/WebstersEnglishDictionary/master/dictionary.json',
            'https://gist.githubusercontent.com/BideoWego/60fbd40d5d1f0f1beca11ba95221dd38/raw/58fb4cce910fbf5fa67a2f0f1f619c09d7b1b373/dictionary.json',
            'https://raw.githubusercontent.com/adambom/dictionary/master/dictionary.json',
            'https://raw.githubusercontent.com/hathibelagal/German-English-JSON-Dictionary/master/german_english.json'
        ];

        async function searchDictionary(word) {
            result.innerHTML = '<p class="loading">Searching...</p>';
            
            try {
                const responses = await Promise.all(dictionaryUrls.map(url => axios.get(url)));
                const dictionaries = responses.map(response => response.data);
                
                let definitionsFound = false;
                let resultHTML = `<h2>Definitions and Translations for "${word}":</h2>`;

                dictionaries.forEach((dictionary, index) => {
                    if (index < 3) {
                        if (dictionary[word.toLowerCase()]) {
                            definitionsFound = true;
                            const definition = dictionary[word.toLowerCase()];
                            resultHTML += `
                                <h3>English Definition (Source ${index + 1}):</h3>
                                <p>${definition}</p>
                            `;
                        }
                    } else {
                        // German-English dictionary
                        const germanTranslations = Object.entries(dictionary).filter(([key, value]) => 
                            value.toLowerCase().includes(word.toLowerCase()) || key.toLowerCase() === word.toLowerCase()
                        );
                        if (germanTranslations.length > 0) {
                            definitionsFound = true;
                            resultHTML += `<h3>German Translations:</h3><ul>`;
                            germanTranslations.forEach(([german, english]) => {
                                resultHTML += `<li>${german} - ${english}</li>`;
                            });
                            resultHTML += `</ul>`;
                        }
                    }
                });

                if (definitionsFound) {
                    result.innerHTML = resultHTML;
                } else {
                    result.innerHTML = `<p>No definition or translation found for "${word}" in any of the sources.</p>`;
                }
            } catch (error) {
                console.error('Error fetching dictionary data:', error);
                result.innerHTML = '<p>An error occurred while searching. Please try again later.</p>';
            }
        }

        searchButton.addEventListener('click', () => {
            const word = searchInput.value.trim();
            if (word) {
                searchDictionary(word);
            }
        });

        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const word = searchInput.value.trim();
                if (word) {
                    searchDictionary(word);
                }
            }
        });
    </script>

    <div class="background-image"></div>
    <div id="thoughtContainer"></div>
    <div id="youtubePlayer"></div>
    <canvas id="snowCanvas"></canvas>

    <div id="controls">
        <button class="control-btn" id="prevBtn">Previous</button>
        <button class="control-btn" id="nextBtn">Next</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
   <script>
 const songs = [
  { id: '2Qs1J612nZs', color: 'red', thumbnail: 'https://granarybooks.cdn.bibliopolis.com/pictures/3025.jpeg?auto=webp&v=1643822358', effect: 'particle' },
  { id: 'STMEyMMnIE8', color: 'grey', thumbnail: 'https://pictures.abebooks.com/isbn/9780394179520-es.jpg', effect: 'particle' },
  { id: 'e2MGdgiQgSI', color: 'white', thumbnail: 'https://i.booksee.org/covers/671000/d2f8946aca4b659de65', effect: 'snow' }
];

  let currentSongIndex = 0;

  const thoughts = [
  // William S. Burroughs
  "Language is a virus from outer space.",
  "Panic is the only responsible reaction to the modern world.",
  "Silence is only frightening to people who are compulsively verbalizing.",
  "Your mind will answer most questions if you learn to relax and wait for the answer.",
  "Nothing is true, everything is permitted.",

  
  // Jack Kerouac
  "The only people for me are the mad ones.",
  "Live, travel, adventure, bless, and don't be sorry.",
  "I had nothing to offer anybody except my own confusion.",
  "My fault is not in the passions I have, but in my lack of control of them.",
  "The air was soft, the stars so fine.",
  "I was surprised, as always, by how easy the act of leaving was.",
  "What's in store for me in the direction I don't take?",

  
  // Bertolt Brecht
  "Art is not a mirror held up to reality but a hammer with which to shape it.",
  "Because things are the way they are, things will not stay the way they are.",
  "Unhappy the land that is in need of heroes.",
  "Grub first, then ethics.",
  "You cannot make a revolution with silk gloves.",
  "From the cradle to the coffin underwear comes first.",
  "Do not fear death so much, but rather the inadequate life.",
  
  // Johann Wolfgang von Goethe
  "Whatever you can do or dream you can, begin it.",
  "None are more hopelessly enslaved than those who falsely believe they are free.",
  "Daring ideas are like chessmen moved forward.",
  "I call architecture frozen music.",
  "One ought, every day at least, to hear a little song.",
  "In the end we are all punished for our virtues.",
  "Behavior is the mirror in which everyone shows their image.",
  
  // Allen Ginsberg
  "I saw the best minds of my generation destroyed by madness.",
  "Follow your inner moonlight; don't hide the madness.",
  "We're not our skin of grime, we're not dread bleak dusty imageless locomotives.",
  
  // Rainer Maria Rilke
  "Go to the limits of your longing.",
  "The only journey is the one within.",
  "Perhaps all the dragons in our lives are princesses.",
  "Live your questions now, and perhaps even then you will live your way to the answer.",
  
  // Friedrich Nietzsche
  "Without music, life would be a mistake.",
  "He who has a why to live can bear almost any how.",
  "That which does not kill us makes us stronger.",
  "There are no facts, only interpretations."

  ];

  function createThought() {
    const thought = document.createElement('div');
    thought.classList.add('thought');
    thought.textContent = thoughts[Math.floor(Math.random() * thoughts.length)];
    thought.style.left = Math.random() * window.innerWidth + 'px';
    thought.style.top = Math.random() * window.innerHeight + 'px';
    thought.style.transform = `rotate(${Math.random() * 360}deg) scale(0)`;
    document.getElementById('thoughtContainer').appendChild(thought);

    setTimeout(() => {
      thought.style.opacity = 1;
      thought.style.transform = `rotate(0deg) scale(1)`;
      thought.classList.add(`${songs[currentSongIndex].color}-glow`);
    }, 100);

    setTimeout(() => {
      thought.style.opacity = 0;
      thought.style.transform = `rotate(${Math.random() * 360}deg) scale(0)`;
      setTimeout(() => thought.remove(), 2000);
    }, 5000);
  }

  setInterval(createThought, 2000);

  // Particle effect
  function createParticle() {
    const particle = document.createElement('div');
    particle.classList.add('particle');
    particle.style.width = `${Math.random() * 5 + 2}px`;
    particle.style.height = particle.style.width;
    particle.style.left = `${Math.random() * window.innerWidth}px`;
    particle.style.top = `${Math.random() * window.innerHeight}px`;
    particle.style.backgroundColor = songs[currentSongIndex].color;
    document.body.appendChild(particle);

    const animation = particle.animate([
      { transform: 'translate(0, 0)', opacity: 1 },
      { transform: `translate(${Math.random() * 200 - 100}px, ${Math.random() * 200 - 100}px)`, opacity: 0 }
    ], {
      duration: Math.random() * 3000 + 2000,
      easing: 'ease-out'
    });

    animation.onfinish = () => particle.remove();
  }

  // YouTube Player
  let player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('youtubePlayer', {
      height: '0',
      width: '0',
      videoId: songs[currentSongIndex].id,
      playerVars: {
        'autoplay': 1,
        'controls': 0,
        'showinfo': 0,
        'modestbranding': 1,
        'loop': 1,
        'playlist': songs[currentSongIndex].id,
        'fs': 0,
        'cc_load_policy': 0,
        'iv_load_policy': 3,
        'autohide': 0
      },
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }

  function onPlayerReady(event) {
    event.target.setVolume(50);
    event.target.playVideo();
    updateBackgroundImage();
    startEffect();
  }

  function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.ENDED) {
      nextSong();
    }
  }

  function updateBackgroundImage() {
    document.querySelector('.background-image').style.backgroundImage = `url('${songs[currentSongIndex].thumbnail}')`;
  }

  // Handle autoplay restrictions
  document.body.addEventListener('click', function() {
    if (player && player.playVideo) {
      player.playVideo();
    }
  });

  // Snow effect
  const snowCanvas = document.getElementById('snowCanvas');
  const snowCtx = snowCanvas.getContext('2d');
  let snowflakes = [];

  function resizeSnowCanvas() {
    snowCanvas.width = window.innerWidth;
    snowCanvas.height = window.innerHeight;
  }

  window.addEventListener('resize', resizeSnowCanvas);
  resizeSnowCanvas();

  function createSnowflake() {
    return {
      x: Math.random() * snowCanvas.width,
      y: 0,
      radius: Math.random() * 3 + 1,
      speed: Math.random() * 3 + 1
    };
  }

  function drawSnow() {
    snowCtx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);
    // Change this line in the drawSnow() function:
snowCtx.fillStyle = 'rgba(255, 0, 0, 0.8)'; // Bright red instead of white

    snowflakes.forEach((flake, index) => {
      snowCtx.beginPath();
      snowCtx.arc(flake.x, flake.y, flake.radius, 0, 2 * Math.PI);
      snowCtx.fill();

      flake.y += flake.speed;
      flake.x += Math.sin(flake.y * 0.05) * 0.5;

      if (flake.y > snowCanvas.height) {
        snowflakes[index] = createSnowflake();
      }
    });

    if (songs[currentSongIndex].effect === 'snow') {
      requestAnimationFrame(drawSnow);
    }
  }

  function initSnow() {
    snowflakes = [];
    for (let i = 0; i < 100; i++) {
      snowflakes.push(createSnowflake());
    }
  }

  let particleInterval;

  function startEffect() {
    // Clear previous effects
    clearInterval(particleInterval);
    snowflakes = [];
    snowCtx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);

    // Remove all existing particles
    document.querySelectorAll('.particle').forEach(p => p.remove());

    // Start new effect
    if (songs[currentSongIndex].effect === 'particle') {
      particleInterval = setInterval(createParticle, 100);
    } else if (songs[currentSongIndex].effect === 'snow') {
      initSnow();
      drawSnow();
    }
  }

  // Song control functions
  function nextSong() {
    currentSongIndex = (currentSongIndex + 1) % songs.length;
    loadCurrentSong();
  }

  function previousSong() {
    currentSongIndex = (currentSongIndex - 1 + songs.length) % songs.length;
    loadCurrentSong();
  }

  function loadCurrentSong() {
    player.loadVideoById(songs[currentSongIndex].id);
    updateBackgroundImage();
    startEffect();
  }

  // Keyboard controls
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') {
      nextSong();
    } else if (e.key === 'ArrowLeft') {
      previousSong();
    }
  });

  // Button controls
  document.getElementById('nextBtn').addEventListener('click', nextSong);
  document.getElementById('prevBtn').addEventListener('click', previousSong);

  // Ensure the first song starts playing and effects are shown
  window.addEventListener('load', () => {
    if (player && player.playVideo) {
      player.playVideo();
    }
    startEffect();
  });
</script>
	<script>
		window.addEventListener('load', () => {
    // Creates an object to easily access URL parameters
    const params = new URLSearchParams(window.location.search);
    
    // Looks for a parameter named 's' (from ?s=...)
    const searchTerm = params.get('s'); 

    // If a search term is found in the URL...
    if (searchTerm) {
        // Optional: Puts the search term into the search box for the user to see
        searchInput.value = searchTerm;
        
        // Runs the search with the term from the URL
        searchDictionary(searchTerm);
    }
});
	</script>
	<!-- Your existing dictionary script above -->

<script>
// F&W Encyclopedia Module
let fawEncyclopedia = {};
let fawLoaded = false;

function toggleEncyclopedia() {
    const panel = document.getElementById('fawPanel');
    if (panel.style.display === 'none' || panel.style.right === '-400px' || panel.style.right === '') {
        panel.style.display = 'block';
        setTimeout(() => {
            panel.style.right = '0';
        }, 10);
        document.getElementById('fawSearch').focus();
    } else {
        panel.style.right = '-400px';
        setTimeout(() => {
            panel.style.display = 'none';
        }, 300);
    }
}

async function loadFunkWagnalls() {
    try {
        const response = await fetch('Funk-And-Wagnalls-New-Encyclopedia-Volume-1_djvu.txt');
        const text = await response.text();
        
        const lines = text.split('\n');
        let currentEntry = null;
        let currentText = [];
        
        lines.forEach(line => {
            const trimmed = line.trim();
            if (/^[A-Z][A-Z\s\-\(\)]{1,40}$/.test(trimmed) && trimmed.length > 2 && !trimmed.includes('.')) {
                if (currentEntry) {
                    fawEncyclopedia[currentEntry.toLowerCase()] = {
                        title: currentEntry,
                        text: currentText.join(' ').replace(/\s+/g, ' ').trim()
                    };
                }
                currentEntry = trimmed;
                currentText = [];
            } else if (currentEntry && trimmed) {
                currentText.push(trimmed);
            }
        });
        
        fawLoaded = true;
        console.log(`F&W Volume I Loaded: ${Object.keys(fawEncyclopedia).length} entries`);
    } catch (error) {
        console.error('F&W Load Error:', error);
    }
}

function searchFunkWagnalls(query) {
    if (!fawLoaded) return null;
    const key = query.toLowerCase();
    if (fawEncyclopedia[key]) return fawEncyclopedia[key];
    
    const matches = Object.entries(fawEncyclopedia).filter(([k, v]) => 
        v.title.toLowerCase().includes(key) || v.text.toLowerCase().includes(key)
    );
    return matches.length > 0 ? matches[0][1] : null;
}

// Load F&W data
loadFunkWagnalls();

// Attach search listener after DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    const fawSearch = document.getElementById('fawSearch');
    if (fawSearch) {
        fawSearch.addEventListener('input', (e) => {
            const query = e.target.value.trim();
            const resultDiv = document.getElementById('fawResult');
            
            if (!query) {
                resultDiv.innerHTML = '<p style="color: #ff4444; font-style: italic;">Enter a term beginning with A through K...</p>';
                return;
            }
            
            const entry = searchFunkWagnalls(query);
            
            if (entry) {
                const text = entry.text.length > 1000 
                    ? entry.text.substring(0, 1000) + '...' 
                    : entry.text;
                    
                resultDiv.innerHTML = `
                    <h3 style="color: #FF0000; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 2px;">${entry.title}</h3>
                    <p style="text-align: justify; border-left: 2px solid rgba(255,0,0,0.3); padding-left: 15px;">${text}</p>
                    <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,0,0,0.2); font-size: 0.8em; color: #ff4444;">
                        Source: Funk & Wagnalls New Encyclopedia (1906), Vol. I
                    </div>
                `;
            } else {
                const firstLetter = query.charAt(0).toUpperCase();
                if (firstLetter.match(/[L-Z]/i)) {
                    resultDiv.innerHTML = `
                        <p style="color: #ff6666;">
                            "<strong>${query}</strong>" would appear in <strong>Volume II</strong> (L–Z).<br><br>
                            <span style="font-size: 0.9em; color: #ff4444;">
                                Only Volume I (A–K) was digitized by the Internet Archive team (2015). 
                                Your physical copy remains the only access to L–Z.
                            </span>
                        </p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: #ff6666;">No entry found for "<strong>${query}</strong>" in Volume I.</p>`;
                }
            }
        });
    }
});
	// Global F&W controller (avoids conflicts)
window.toggleFW = function() {
    const panel = document.getElementById('fawPanel');
    if (!panel) {
        console.error('Panel not found!');
        return;
    }
    
    console.log('Toggling panel. Current display:', panel.style.display, 'Right:', panel.style.right);
    
    if (panel.style.display === 'none' || panel.style.display === '' || panel.style.right === '-400px') {
        panel.style.display = 'block';
        // Force reflow
        void panel.offsetWidth;
        panel.style.right = '0';
        setTimeout(() => {
            const input = document.getElementById('fawInput');
            if (input) input.focus();
        }, 100);
    } else {
        panel.style.right = '-400px';
        setTimeout(() => {
            panel.style.display = 'none';
        }, 300);
    }
};

// Ensure it loads after everything
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFW);
} else {
    initFW();
}

function initFW() {
    console.log('F&W Init started');
    
    // Load the text file
    fetch('Funk-And-Wagnalls-New-Encyclopedia-Volume-1_djvu.txt')
        .then(r => r.text())
        .then(text => {
            console.log('F&W file loaded, size:', text.length);
            window.fawData = {};
            
            const lines = text.split('\n');
            let entry = null;
            let content = [];
            
            lines.forEach(line => {
                const t = line.trim();
                if (/^[A-Z][A-Z\s\-]{2,40}$/.test(t) && !t.includes('.') && t.length < 50) {
                    if (entry) {
                        window.fawData[entry.toLowerCase()] = {
                            title: entry,
                            text: content.join(' ').substring(0, 2000) // Limit length
                        };
                    }
                    entry = t;
                    content = [];
                } else if (entry && t) {
                    content.push(t);
                }
            });
            
            console.log('Parsed entries:', Object.keys(window.fawData).length);
        })
        .catch(e => console.error('Failed to load F&W:', e));
    
    // Search handler
    const input = document.getElementById('fawInput');
    if (input) {
        input.addEventListener('input', (e) => {
            const q = e.target.value.trim().toLowerCase();
            const out = document.getElementById('fawOutput');
            
            if (!q) {
                out.innerHTML = '<p style="color: #ff4444;">Type to search...</p>';
                return;
            }
            
            if (!window.fawData) {
                out.innerHTML = '<p style="color: #ff4444;">Loading encyclopedia...</p>';
                return;
            }
            
            const found = window.fawData[q] || 
                Object.values(window.fawData).find(v => 
                    v.title.toLowerCase().includes(q) || v.text.toLowerCase().includes(q)
                );
            
            if (found) {
                out.innerHTML = `
                    <h3 style="color: #FF0000; margin-bottom: 10px;">${found.title}</h3>
                    <p style="border-left: 2px solid #FF0000; padding-left: 10px;">${found.text.substring(0, 500)}...</p>
                `;
            } else if (q.match(/^[l-z]/)) {
                out.innerHTML = `<p style="color: #ff6666;">"${q}" is in Volume II (L–Z)<br><small>Not digitized. Check your physical copy.</small></p>`;
            } else {
                out.innerHTML = `<p style="color: #ff6666;">"${q}" not found in Volume I.</p>`;
            }
        });
    }
}
</script>
</body>
</html>
