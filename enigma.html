<!DOCTYPE html>
<html>
<head>
  <title>NEXUS Code Machine</title>
  <style>
    body {
      background-image: url('https://cdn.britannica.com/15/25015-050-180E683B/computer-Colossus-Bletchley-Park-Buckinghamshire-England-Funding-1943.jpg'); 
      background-size: cover;   
      background-repeat: no-repeat; 
      background-position: center;
      background-attachment: fixed;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Slightly more modern font */
      -webkit-font-smoothing: antialiased;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background-color: #111; /* Darker fallback */
      color: #eee; 
      margin: 0;
      padding: 20px 0;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
      color: #fff;
      text-shadow: 2px 2px 4px #000;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    h2 {
      margin-top: 0;
      border-bottom: 1px solid #cc0000; /* Red underline */
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    /* Main Card Styling */
    .container {
      width: 36rem;
      max-width: 90%;
      background-color: rgba(18, 18, 18, 0.95); /* Deep Black/Grey with slight transparency */
      border: 1px solid #333;
      border-top: 4px solid #cc0000; /* Red accent top */
      border-radius: 0.25rem;
      padding: 2rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.8);
      margin-bottom: 2rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      color: #bbb; /* Light Grey text */
      font-weight: bold;
      font-size: 0.9rem;
      text-transform: uppercase;
    }

    /* Inputs and Selects styling */
    input[type="text"],
    textarea, 
    select {
      width: 100%;
      box-sizing: border-box; /* Ensures padding doesn't break layout */
      padding: 0.75rem;
      margin-bottom: 1rem; 
      border-radius: 0; /* Squared off edges for industrial look */
      border: 1px solid #444;
      background-color: #000; /* Pure Black input background */
      color: #fff;
      font-family: monospace; /* Code look */
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #cc0000; /* Red glow on focus */
    }

    /* Button Styling */
    button {
      padding: 0.75rem 1.5rem;
      border: 1px solid #444;
      border-radius: 0;
      font-weight: bold;
      cursor: pointer;
      margin-right: 0.5rem; 
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: all 0.2s ease;
      font-size: 0.85rem;
    }

    /* Primary Action - Red */
    .cipher {
      background-color: #cc0000; 
      color: white; 
      border-color: #cc0000;
    }
    .cipher:hover {
      background-color: #ff0000;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.4);
    }

    /* Secondary Actions - Dark Grey/Black */
    .decipher, .generate-key, .use-custom-code, button {
      background-color: #222; 
      color: #fff; 
    }
    
    .decipher:hover, .generate-key:hover, .use-custom-code:hover, button:hover {
      background-color: #444;
      border-color: #fff;
    }

    /* Help Tooltip */
    .help-menu {
      position: absolute;
      top: 1.5rem;
      right: 1.5rem;
    }

    .help-icon {
      cursor: pointer;
      font-size: 1.2rem;
      opacity: 0.7;
    }
    
    .container {
        position: relative; /* Needed for absolute positioning of help icon */
    }

    .tooltip {
      position: absolute;
      top: 100%;
      right: 0; /* Align right */
      width: 250px;
      transform: none;
      background-color: #000;
      border: 1px solid #cc0000;
      color: #ddd;
      padding: 1rem;
      z-index: 10;
      opacity: 0;
      visibility: hidden; 
      transition: opacity 0.2s, visibility 0.2s;
      text-align: left;
      font-size: 0.9rem;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }

    .help-menu:hover .tooltip { 
      opacity: 1;
      visibility: visible;
    }
    
    /* Enigma Specific Layout */
    .enigma-row {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .enigma-group {
      flex: 1;
    }
  </style>
</head>
<body>

  <h1>NEXUS Code Machine</h1>

  <div class="container">
    <div class="help-menu"> 
      <span class="help-icon">❓</span>
      <div class="tooltip">
        <p><b style="color: #cc0000;">NEXUS Code Machine</b></p>
        <p>Enter your message, choose a key (or generate one), and click Cipher or Decipher. </p>
        <p><i>Note: "Generate Key" creates a random sequence.</i></p> 
      </div>
    </div> 

    <div>
      <label for="key">Key:</label>
      <input type="text" id="key" value="default">
      <div style="display:flex; flex-wrap:wrap;">
        <button class="generate-key" onclick="generateKey()">Generate Key</button>
        <button class="use-custom-code" onclick="useCustomCode()">Use Custom Code</button> 
      </div>
    </div>

   <div style="margin-top: 1rem;">
      <label for="input">Input:</label>
      <textarea id="input" rows="4"></textarea> 
    </div>

    <div>
      <button class="cipher" onclick="cipher()">Cipher</button>
      <button class="decipher" onclick="decipher()">Decipher</button>
    </div>

    <div style="margin-top: 1rem;">
      <label for="output">Output:</label>
      <textarea id="output" rows="4" readonly style="background-color: #0a0a0a; color: #888;"></textarea>
    </div>
  </div>

  <!-- Enigma Section - Now wrapped in a matching container -->
  <div class="container">
    <h2>Streamlined Enigma</h2>
    <div class="help-menu"> 
        <span class="help-icon">❓</span>
        <div class="tooltip">
          <p><strong>Enigma Simulation</strong></p>
          <p>A simplified version of the machine invented by Arthur Scherbius. Intended for educational purposes to illustrate basic encryption concepts.</p>
        </div>
      </div> 

    <div class="enigma-row">
      <div class="enigma-group">
        <label for="enigma-rotor1">Rotor 1:</label>
        <select id="enigma-rotor1">
          <option value="rotor1">Rotor I</option>
          <option value="rotor2">Rotor II</option> 
        </select>
      </div>
      <div class="enigma-group">
        <label for="enigma-position1">Pos 1:</label>
        <select id="enigma-position1">
          <option value="A">A</option><option value="B">B</option><option value="C">C</option>
          <option value="D">D</option><option value="E">E</option><option value="F">F</option>
        </select>
      </div>
    </div>

    <div class="enigma-row">
      <div class="enigma-group">
        <label for="enigma-rotor2">Rotor 2:</label>
        <select id="enigma-rotor2">
          <option value="rotor1">Rotor I</option>
          <option value="rotor2">Rotor II</option> 
        </select>
      </div>
      <div class="enigma-group">
        <label for="enigma-position2">Pos 2:</label>
        <select id="enigma-position2">
          <option value="A">A</option><option value="B">B</option><option value="C">C</option>
          <option value="D">D</option><option value="E">E</option><option value="F">F</option>
        </select>
      </div>
    </div>

    <div>
      <button class="cipher" onclick="enigmaCipher()">Enigma Cipher</button>
      <button class="decipher" onclick="enigmaDecipher()">Enigma Decipher</button>
    </div>
  </div>

<script>
    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    const symbols = '!@#$%^&*()_+=-`~[]\{}|;\':",./<>?';

    // Define your custom symbol-based code:
    const customCode = {
      'A': '!', 'B': '@', 'C': '#', 'D': '$', 'E': '%', 'F': '^', 
      'G': '&', 'H': '*', 'I': '(', 'J': ')', 'K': '_', 'L': '+', 
      'M': '-', 'N': '=', 'O': '`', 'P': '~', 'Q': '[', 'R': ']',
      'S': '{', 'T': '}', 'U': '|', 'V': ';', 'W': ':', 'X': '\'',
      'Y': '"', 'Z': '<', '0': '>', '1': '.', '2': ',', '3': '/', 
      '4': '?', '5': '\\', '6': '7', '7': '8', '8': '9', '9': '0' 
    };

    function generateKey() {
      let newKey = '';
      for (let i = 0; i < 10; i++) {
        newKey += alphabet[Math.floor(Math.random() * alphabet.length)];
      }
      document.getElementById('key').value = newKey;
    }

    function useCustomCode() {
      document.getElementById('key').value = "(CUSTOM CODE)"; 
    }

    function cipher() {
      const input = document.getElementById('input').value.toUpperCase();
      const key = document.getElementById('key').value.toUpperCase();
      let result = '';

      for (let i = 0; i < input.length; i++) {
        const char = input[i];
        
        if (key === "(CUSTOM CODE)") {
          result += customCode[char] || char; 
        } else {
          const index = alphabet.indexOf(char);
          if (index !== -1) {
            const shiftedIndex = (index + alphabet.indexOf(key[i % key.length])) % alphabet.length;
            result += alphabet[shiftedIndex];
          } else {
            result += char;
          }
        }
      }
      document.getElementById('output').value = result;
    }

    function decipher() {
      const input = document.getElementById('input').value.toUpperCase();
      const key = document.getElementById('key').value.toUpperCase();
      let result = '';

      for (let i = 0; i < input.length; i++) {
        const char = input[i];

        if (key === "(CUSTOM CODE)") {
          for (const [plain, coded] of Object.entries(customCode)) {
            if (coded === char) {
              result += plain;
              break;
            }
          }
          if (!Object.values(customCode).includes(char)) {
            result += char; 
          }
        } else {
          const index = alphabet.indexOf(char);
          if (index !== -1) {
            let shiftedIndex = (index - alphabet.indexOf(key[i % key.length]) + alphabet.length) % alphabet.length;
            result += alphabet[shiftedIndex];
          } else {
            result += char;
          }
        }
      }
      document.getElementById('output').value = result;
    }

// Enigma Logic
const rotor1Wiring = {
  'A': 'D', 'B': 'K', 'C': 'V', 'D': 'Q', 'E': 'L', 'F': 'G', 
  'G': 'Z', 'H': 'B', 'I': 'P', 'J': 'S', 'K': 'O', 'L': 'M', 
  'M': 'R', 'N': 'W', 'O': 'C', 'P': 'I', 'Q': 'U', 'R': 'Y', 
  'S': 'A', 'T': 'N', 'U': 'F', 'V': 'X', 'W': 'J', 'X': 'H',
  'Y': 'T', 'Z': 'E'
};

const rotor2Wiring = {
  'A': 'H', 'B': 'Q', 'C': 'Z', 'D': 'G', 'E': 'P', 'F': 'J', 
  'G': 'T', 'H': 'M', 'I': 'O', 'J': 'B', 'K': 'L', 'L': 'N', 
  'M': 'C', 'N': 'V', 'O': 'F', 'P': 'D', 'Q': 'U', 'R': 'S', 
  'S': 'R', 'T': 'A', 'U': 'X', 'V': 'Y', 'W': 'I', 'X': 'K',
  'Y': 'E', 'Z': 'W' 
};

function encryptLetter(letter, rotorWiring, position) {
  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  let letterIndex = alphabet.indexOf(letter);
  if(letterIndex === -1) return letter;
  letterIndex = (letterIndex + alphabet.indexOf(position)) % 26;
  const substitutedLetter = rotorWiring[alphabet[letterIndex]];
  let substitutedIndex = alphabet.indexOf(substitutedLetter);
  substitutedIndex = (substitutedIndex - alphabet.indexOf(position) + 26) % 26;
  return alphabet[substitutedIndex];
}

function decryptLetter(letter, rotorWiring, position) {
  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  let letterIndex = alphabet.indexOf(letter);
  if(letterIndex === -1) return letter;
  letterIndex = (letterIndex + alphabet.indexOf(position)) % 26;
  let originalLetter = '';
  for (const [key, value] of Object.entries(rotorWiring)) {
    if (value === alphabet[letterIndex]) {
      originalLetter = key;
      break;
    }
  }
  let originalIndex = alphabet.indexOf(originalLetter);
  originalIndex = (originalIndex - alphabet.indexOf(position) + 26) % 26;
  return alphabet[originalIndex];
}

function enigmaCipher() {
  const inputText = document.getElementById('input').value.toUpperCase();
  const rotor1 = document.getElementById('enigma-rotor1').value;
  const position1 = document.getElementById('enigma-position1').value;
  const rotor2 = document.getElementById('enigma-rotor2').value;
  const position2 = document.getElementById('enigma-position2').value;
  let outputText = '';

  for (let i = 0; i < inputText.length; i++) {
    let letter = inputText[i];
    if (letter.match(/[A-Z]/)) {
      letter = encryptLetter(letter, eval(rotor1 + 'Wiring'), position1);
      letter = encryptLetter(letter, eval(rotor2 + 'Wiring'), position2);
    }
    outputText += letter;
  }
  document.getElementById('output').value = outputText;
}

function enigmaDecipher() {
  const inputText = document.getElementById('input').value.toUpperCase();
  const rotor1 = document.getElementById('enigma-rotor1').value;
  const position1 = document.getElementById('enigma-position1').value;
  const rotor2 = document.getElementById('enigma-rotor2').value;
  const position2 = document.getElementById('enigma-position2').value;
  let outputText = '';

  for (let i = 0; i < inputText.length; i++) {
    let letter = inputText[i];
    if (letter.match(/[A-Z]/)) {
      letter = decryptLetter(letter, eval(rotor2 + 'Wiring'), position2);
      letter = decryptLetter(letter, eval(rotor1 + 'Wiring'), position1);
    }
    outputText += letter;
  }
  document.getElementById('output').value = outputText;
}
</script>

</body>
</html>
