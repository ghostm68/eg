<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Novel Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> 
  <style>
  * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
html, body {
  height: 100%;
  width: 100%;
  overflow: hidden; 
}
body {
  font-family: "Roboto", sans-serif;
  perspective: 1px;
}
#content-wrapper {
  position: relative;
  height: 100%;
  overflow-y: scroll; /* Allow scrolling for content */
  background-color: #f8f8f8; 
}
#content {
  font-size: 24px;
  line-height: 1.6;
  padding: 50px 100px; 
  transform: translateZ(0); 
  color: #666; /* Ash color */
}
#background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  z-index: -1;
  transform: translateZ(-1px) scale(2); 
  transition: background-image 1s ease; 
  background-attachment: fixed; /*  Keep the background fixed */
  transform: translateZ(-10px) scale(1.5); /* Adjust scale for parallax */
}
  </style>
</head>
<body>
  <div id="content-wrapper">
    <div id="background"></div>
    <div id="content"> 
      </div>
  </div>

  <script>
    let currentImageIndex = 0;
    let imageData = [];

    $(document).ready(function() {
      $.getJSON("your-images.json", function(data) {
        imageData = data;
        setBackgroundImage(0);

        $.get('horse.txt', function(text) {
          $('#content').text(text);

          let chapters = text.split("## ");
          const finalChapters = [];
          let currentChapter = null;

          for (let i = 0; i < chapters.length; i++) {
            const chapter = chapters[i];
            const heading = chapter.split("\n")[0]; 

            if (heading.startsWith("Chapter") || heading.startsWith("Section")) {
              currentChapter = chapter;
            } else if (currentChapter) {
              currentChapter += "## " + chapter; 
            } else if (heading === "PDF_NOTES_START") { 
              finalChapters.push('<a href="your-notes.pdf" target="_blank">Chapter 2 Notes (PDF)</a>');
            } else if (heading === "PRELUDE_CHAPTER_THREE_START") {
              finalChapters.push('<div id="prelude-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "INTRODUCTION_CHAPTER_THREE_START") {
              finalChapters.push('<div id="introduction-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "GENESIS_AND_REVELATION_CHAPTER_THREE_START") {
              finalChapters.push('<div id="genesis-and-revelation-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "TWO_DAYS_EARLIER_CHAPTER_THREE_START") {
              finalChapters.push('<div id="two-days-earlier-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "CONTEXT_CHAPTER_THREE_START") {
              finalChapters.push('<div id="context-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "POV_CHAPTER_THREE_START") {
              finalChapters.push('<div id="pov-chapter-three">' + chapter + '</div>'); 
            } else if (heading === "NOTES_CHAPTER_THREE_START") {
              finalChapters.push('<div id="notes-chapter-three">' + chapter + '</div>'); 
            } else if (heading.startsWith("Chapter Four - i") || heading.startsWith("Chapter Four - ii") || heading.startsWith("Chapter Four - post-script")) { 
              finalChapters.push('<div id="chapter-four-section-' + i + '">' + chapter + '</div>'); 
            } else if (currentChapter) { 
              finalChapters.push(currentChapter); 
              currentChapter = null;
            } 
          }

          $('#content').html(finalChapters.join('')); // Display the chapters
        });
      });

      function setBackgroundImage(index) {
        if (imageData.length > 0) {
          index = index % imageData.length;
          const imageUrl = imageData[index].image; 
          $('#background').css('background-image', 'url(' + imageUrl + ')');
        }
      }
    });
  </script>
</body>
</html>
