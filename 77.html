<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordStar Nexus Seven</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #menu-bar, #footer {
            display: flex;
            flex-wrap: wrap;
            background-color: #333;
            color: white;
            padding: 5px;
        }
        .menu-item, .tab {
            margin-right: 15px;
            cursor: pointer;
            padding: 2px 5px;
        }
        .menu-item:hover, .tab:hover {
            background-color: #555;
        }
        .shortcut {
            font-size: 0.8em;
            color: #aaa;
        }
        #editor-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 10px;
            background-color: white;
        }
        #ruler {
            height: 20px;
            background-color: #eee;
            border-bottom: 1px solid #ccc;
            font-size: 12px;
            display: flex;
            padding-left: 5px;
        }
        #editor {
            flex-grow: 1;
            border: none;
            outline: none;
            padding: 10px;
            font-size: 16px;
            line-height: 1.5;
            resize: none;
        }
        #status-bar {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="menu-bar">
        <div class="menu-item" onclick="toggleBold()"><span class="shortcut">^B</span> Bold</div>
        <div class="menu-item" onclick="toggleItalic()"><span class="shortcut">^I</span> Italic</div>
        <div class="menu-item" onclick="toggleUnderline()"><span class="shortcut">^U</span> Underline</div>
        <div class="menu-item" onclick="insertDateTime()"><span class="shortcut">^D</span> Date/Time</div>
        <div class="menu-item" onclick="wordCount()"><span class="shortcut">^W</span> Word Count</div>
        <div class="menu-item" onclick="toggleSpellCheck()"><span class="shortcut">^S</span> Spell Check</div>
        <div class="menu-item" onclick="toggleRuler()"><span class="shortcut">^R</span> Ruler</div>
        <div class="menu-item" onclick="saveDocument()"><span class="shortcut">^O</span> Save</div>
        <div class="menu-item" onclick="printDocument()"><span class="shortcut">^P</span> Print</div>
        <div class="menu-item" onclick="findReplace()"><span class="shortcut">^F</span> Find/Replace</div>
        <div class="menu-item" onclick="toggleReadingMode()"><span class="shortcut">^M</span> Reading Mode</div>
        <div class="menu-item" onclick="generateLoremIpsum()"><span class="shortcut">^L</span> Lorem Ipsum</div>
        <div class="menu-item" onclick="calculateStats()"><span class="shortcut">^T</span> Text Stats</div>
    </div>

    <div id="editor-container">
        <div id="ruler"></div>
        <textarea id="editor" spellcheck="false">Welcome to WordStar Nexus Seven! A writing space. Enjoy the feel of the classic word processing preferred by William F Buckley jr. now with modern web technologies. (Use the menu bar above for quick access to common functions, and explore additional features using the menu items...)</textarea>
    </div>

    <div id="footer">
        <div class="tab" onclick="showTab('File')">File</div>
        <div class="tab" onclick="showTab('Edit')">Edit</div>
        <div class="tab" onclick="showTab('Format')">Format</div>
        <div class="tab" onclick="showTab('View')">View</div>
        <div class="tab" onclick="showTab('Tools')">Tools</div>
        <div class="tab" onclick="showTab('Help')">Help</div>

        <div id="status-bar">
            <span id="cursor-position">Line: 1 Col: 1</span>
            <span id="word-count">Words: 0</span>
            <span id="insert-mode">INSERT</span>
            <span id="file-name">Untitled</span>
        </div>
    </div>

    <script>
        const editor = document.getElementById('editor');
        const ruler = document.getElementById('ruler');
        let spellCheckEnabled = false;
        let readingMode = false;

        function updateCursorPosition() {
            const text = editor.value;
            const cursorPos = editor.selectionStart;
            const textBeforeCursor = text.substring(0, cursorPos);
            const lines = textBeforeCursor.split('\n');
            const currentLine = lines.length;
            const currentCol = lines[lines.length - 1].length + 1;
            document.getElementById('cursor-position').textContent = `Line: ${currentLine} Col: ${currentCol}`;
        }

        function updateWordCount() {
            const words = editor.value.trim().split(/\s+/).length;
            document.getElementById('word-count').textContent = `Words: ${words}`;
        }

        function toggleBold() {
            document.execCommand('bold', false, null);
        }

        function toggleItalic() {
            document.execCommand('italic', false, null);
        }

        function toggleUnderline() {
            document.execCommand('underline', false, null);
        }

        function insertDateTime() {
            const now = new Date();
            const dateTime = now.toLocaleString();
            const cursorPos = editor.selectionStart;
            editor.value = editor.value.slice(0, cursorPos) + dateTime + editor.value.slice(cursorPos);
            updateWordCount();
        }

        function wordCount() {
            const words = editor.value.trim().split(/\s+/).length;
            alert(`Word count: ${words}`);
        }

        function toggleSpellCheck() {
            spellCheckEnabled = !spellCheckEnabled;
            editor.spellcheck = spellCheckEnabled;
            alert(`Spell check ${spellCheckEnabled ? 'enabled' : 'disabled'}.`);
        }

        function toggleRuler() {
            ruler.style.display = ruler.style.display === 'none' ? 'flex' : 'none';
        }

        function saveDocument() {
            const blob = new Blob([editor.value], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'document.txt';
            a.click();
        }

        function printDocument() {
            window.print();
        }

        function findReplace() {
            const searchTerm = prompt("Enter the text to search for:");
            if (searchTerm) {
                const replaceTerm = prompt("Enter the replacement text:");
                if (replaceTerm !== null) {
                    editor.value = editor.value.replace(new RegExp(searchTerm, 'g'), replaceTerm);
                    updateWordCount();
                }
            }
        }

        function toggleReadingMode() {
            readingMode = !readingMode;
            if (readingMode) {
                editor.style.fontSize = '18px';
                editor.style.lineHeight = '1.8';
                editor.style.maxWidth = '800px';
                editor.style.margin = 'auto';
                editor.style.padding = '20px';
                editor.style.backgroundColor = '#f9f9f9';
            } else {
                editor.style.fontSize = '';
                editor.style.lineHeight = '';
                editor.style.maxWidth = '';
                editor.style.margin = '';
                editor.style.padding = '';
                editor.style.backgroundColor = '';
            }
        }

        function generateLoremIpsum() {
            const loremIpsum = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            const cursorPos = editor.selectionStart;
            editor.value = editor.value.slice(0, cursorPos) + loremIpsum + editor.value.slice(cursorPos);
            updateWordCount();
        }

        function calculateStats() {
            const text = editor.value;
            const charCount = text.length;
            const wordCount = text.trim().split(/\s+/).length;
            const sentenceCount = text.split(/[.!?]+/).length - 1;
            const paragraphCount = text.split(/\n\s*\n/).length;
            
            alert(`Text Statistics:
                Characters: ${charCount}
                Words: ${wordCount}
                Sentences: ${sentenceCount}
                Paragraphs: ${paragraphCount}
                Average word length: ${(charCount / wordCount).toFixed(2)} characters
                Average sentence length: ${(wordCount / sentenceCount).toFixed(2)} words`);
        }

        function showTab(tabName) {
            alert(`${tabName} tab clicked. This feature is not yet fully implemented.`);
        }

        function initRuler() {
            for (let i = 1; i <= 80; i++) {
                if (i % 10 === 0) {
                    ruler.innerHTML += `<span style="flex: 0 0 50px; text-align: center;">${i}</span>`;
                } else if (i % 5 === 0) {
                    ruler.innerHTML += '<span style="flex: 0 0 50px; text-align: center;">|</span>';
                } else {
                    ruler.innerHTML += '<span style="flex: 0 0 50px;"></span>';
                }
            }
        }

        editor.addEventListener('input', () => {
            updateCursorPosition();
            updateWordCount();
        });

        editor.addEventListener('click', updateCursorPosition);
        editor.addEventListener('keyup', updateCursorPosition);

        initRuler();
        updateWordCount();
    </script>
</body>
</html>
